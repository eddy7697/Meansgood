!function(t){function e(n){if(a[n])return a[n].exports;var o=a[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var a={};e.m=t,e.c=a,e.d=function(t,a,n){e.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=224)}({1:function(t,e){t.exports=function(t,e,a,n,o,r){var i,s=t=t||{},c=typeof t.default;"object"!==c&&"function"!==c||(i=t,s=t.default);var l="function"==typeof s?s.options:s;e&&(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0),a&&(l.functional=!0),o&&(l._scopeId=o);var d;if(r?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},l._ssrRegister=d):n&&(d=n),d){var u=l.functional,f=u?l.render:l.beforeCreate;u?(l._injectStyles=d,l.render=function(t,e){return d.call(e),f(t,e)}):l.beforeCreate=f?[].concat(f,d):[d]}return{esModule:i,exports:s,options:l}}},10:function(t,e){function a(t,e){var a=t[1]||"",n=t[3];if(!n)return a;if(e&&"function"==typeof btoa){var o=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(n),r=n.sources.map(function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"});return[a].concat(r).concat([o]).join("\n")}return[a].join("\n")}t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=a(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,a){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},o=0;o<this.length;o++){var r=this[o][0];"number"==typeof r&&(n[r]=!0)}for(o=0;o<t.length;o++){var i=t[o];"number"==typeof i[0]&&n[i[0]]||(a&&!i[2]?i[2]=a:a&&(i[2]="("+i[2]+") and ("+a+")"),e.push(i))}},e}},11:function(t,e,a){function n(t){for(var e=0;e<t.length;e++){var a=t[e],n=l[a.id];if(n){n.refs++;for(var o=0;o<n.parts.length;o++)n.parts[o](a.parts[o]);for(;o<a.parts.length;o++)n.parts.push(r(a.parts[o]));n.parts.length>a.parts.length&&(n.parts.length=a.parts.length)}else{var i=[];for(o=0;o<a.parts.length;o++)i.push(r(a.parts[o]));l[a.id]={id:a.id,refs:1,parts:i}}}}function o(){var t=document.createElement("style");return t.type="text/css",d.appendChild(t),t}function r(t){var e,a,n=document.querySelector('style[data-vue-ssr-id~="'+t.id+'"]');if(n){if(g)return p;n.parentNode.removeChild(n)}if(m){var r=f++;n=u||(u=o()),e=i.bind(null,n,r,!1),a=i.bind(null,n,r,!0)}else n=o(),e=function(t,e){var a=e.css,n=e.media,o=e.sourceMap;n&&t.setAttribute("media",n);o&&(a+="\n/*# sourceURL="+o.sources[0]+" */",a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");if(t.styleSheet)t.styleSheet.cssText=a;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(a))}}.bind(null,n),a=function(){n.parentNode.removeChild(n)};return e(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;e(t=n)}else a()}}function i(t,e,a,n){var o=a?"":n.css;if(t.styleSheet)t.styleSheet.cssText=v(e,o);else{var r=document.createTextNode(o),i=t.childNodes;i[e]&&t.removeChild(i[e]),i.length?t.insertBefore(r,i[e]):t.appendChild(r)}}var s="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!s)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var c=a(12),l={},d=s&&(document.head||document.getElementsByTagName("head")[0]),u=null,f=0,g=!1,p=function(){},m="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());t.exports=function(t,e,a){g=a;var o=c(t,e);return n(o),function(e){for(var a=[],r=0;r<o.length;r++){var i=o[r];(s=l[i.id]).refs--,a.push(s)}e?n(o=c(t,e)):o=[];for(r=0;r<a.length;r++){var s;if(0===(s=a[r]).refs){for(var d=0;d<s.parts.length;d++)s.parts[d]();delete l[s.id]}}}};var v=function(){var t=[];return function(e,a){return t[e]=a,t.filter(Boolean).join("\n")}}()},12:function(t,e){t.exports=function(t,e){for(var a=[],n={},o=0;o<e.length;o++){var r=e[o],i=r[0],s={id:t+":"+o,css:r[1],media:r[2],sourceMap:r[3]};n[i]?n[i].parts.push(s):a.push(n[i]={id:i,parts:[s]})}return a}},133:function(t,e,a){var n=a(1)(a(136),a(137),!1,function(t){a(134)},null,null);t.exports=n.exports},134:function(t,e,a){var n=a(135);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(11)("059968d1",n,!0)},135:function(t,e,a){(t.exports=a(10)(void 0)).push([t.i,'.ckeditor:after{content:"";display:table;clear:both}',""])},136:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(new Date).getTime();e.default={name:"vue-ckeditor",props:{name:{type:String,default:function(){return"editor-"+ ++n}},value:{type:String},id:{type:String,default:function(){return"editor-"+n}},types:{type:String,default:function(){return"classic"}},config:{type:Object,default:function(){}}},data:function(){return{destroyed:!1}},computed:{instance:function(){return CKEDITOR.instances[this.id]}},watch:{value:function(t){this.instance&&this.update(t)}},mounted:function(){this.create()},beforeDestroy:function(){this.destroy()},methods:{create:function(){"undefined"==typeof CKEDITOR?console.log("CKEDITOR is missing (http://ckeditor.com/)"):("inline"===this.types?CKEDITOR.inline(this.id,this.config):CKEDITOR.replace(this.id,this.config),this.instance.setData(this.value),this.instance.on("change",this.onChange),this.instance.on("blur",this.onBlur),this.instance.on("focus",this.onFocus))},update:function(t){this.instance.getData()!==t&&this.instance.setData(t)},destroy:function(){this.destroyed||(this.instance.focusManager.blur(!0),this.instance.removeAllListeners(),this.instance.destroy(),this.destroyed=!0)},onChange:function(){var t=this.instance.getData();t!==this.value&&this.$emit("input",t)},onBlur:function(){this.$emit("blur",this.instance)},onFocus:function(){this.$emit("focus",this.instance)}}}},137:function(t,e){t.exports={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ckeditor"},[e("textarea",{attrs:{name:this.name,id:this.id,types:this.types,config:this.config},domProps:{value:this.value}})])},staticRenderFns:[]}},224:function(t,e,a){t.exports=a(225)},225:function(t,e,a){Vue.component("product-category",a(226));new Vue({el:"#product-category"})},226:function(t,e,a){var n=a(1)(a(227),a(228),!1,null,null,null);t.exports=n.exports},227:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(133),o=a.n(n);e.default={components:{Ckeditor:o.a},data:function(){return{addCategoryForm:{categoryName:"",categoryParent:null,type:"product",description:null,featureImage:null},editCategoryForm:{guid:null,categoryName:null,categoryParent:null,type:"product",description:null,featureImage:null},ckConfig:{height:300,allowedContent:!0,filebrowserImageBrowseUrl:"/laravel-filemanager?type=Images",filebrowserImageUploadUrl:"/laravel-filemanager/upload?type=Images&_token="+$('meta[name="csrf-token"]').attr("content"),filebrowserBrowseUrl:"/laravel-filemanager?type=Files",filebrowserUploadUrl:"/laravel-filemanager/upload?type=Files&_token="+$('meta[name="csrf-token"]').attr("content")},categories:[],token:$('meta[name="csrf-token"]').attr("content")}},created:function(){this.getCategories(),$(".loading-bar").fadeOut("100"),console.log(123),$.ajax({url:"https://cdn.rawgit.com/mar10/fancytree/72e03685/demo/ajax-tree-products.json",type:"GET",dataType:"json"}).done(function(t){console.log(t),$("#tree").fancytree({checkbox:!0,selectMode:3,source:t,lazyLoad:function(t,e){},activate:function(t,e){},select:function(t,e){}})}).fail(function(){console.log("error")}).always(function(){console.log("complete")})},methods:{addCategory:function(){var t=this,e=this.token;void 0===t.addCategoryForm.categoryParent&&(t.addCategoryForm.categoryParent=null),""!==t.addCategoryForm.categoryName.trim()?($(".loading-bar").fadeIn("100"),$.ajax({url:"/admin/category/add",type:"POST",cache:!1,dataType:"json",data:t.addCategoryForm,beforeSend:function(t){t.setRequestHeader("X-CSRF-TOKEN",e)}}).done(function(e){t.showMessage("success","新增類別成功"),t.addCategoryForm.categoryParent=null,t.addCategoryForm.categoryName=null,t.addCategoryForm.description=null,t.addCategoryForm.featureImage=null}).fail(function(){console.log("error")}).always(function(){t.getCategories(),$(".loading-bar").fadeOut("100")})):this.showMessage("warning","欄位名稱不可為空白")},addImage:function(){var t=this;window.open("/laravel-filemanager?type=Images","FileManager","width=1280,height=1024"),window.SetUrl=function(e,a){t.addCategoryForm.featureImage=a}},editImage:function(){var t=this;window.open("/laravel-filemanager?type=Images","FileManager","width=1280,height=1024"),window.SetUrl=function(e,a){t.editCategoryForm.featureImage=a}},editCategory:function(t){var e=this,a=this.token;""!==t.categoryName.trim()?($(".loading-bar").fadeIn("100"),$.ajax({url:"/admin/category/update",type:"POST",dataType:"json",data:{category:t.guid,name:t.categoryName,parentId:t.categoryParent,description:t.description},beforeSend:function(t){t.setRequestHeader("X-CSRF-TOKEN",a)}}).done(function(t){e.getCategories(),e.showMessage("success","類別編輯成功"),$("#myModal").modal("hide")}).fail(function(t){console.log("error")}).always(function(){$(".edit-category-input").blur(),$(".loading-bar").fadeOut("100"),console.log("complete")})):this.showMessage("warning","欄位名稱不可為空白")},deleteCategory:function(t){var e=this,a=this.token;confirm("是否刪除類別?")&&$.ajax({url:"/admin/category/delete",type:"POST",dataType:"json",data:{category:t},beforeSend:function(t){t.setRequestHeader("X-CSRF-TOKEN",a)}}).done(function(t){e.showMessage("success",t.message)}).fail(function(t){e.showMessage("error",t.responseJSON.message)}).always(function(){e.getCategories()})},openEditModal:function(t){this.editCategoryForm.categoryName=t.name,this.editCategoryForm.categoryParent=t.categoryParent,this.editCategoryForm.description=t.description,this.editCategoryForm.guid=t.guid,$("#myModal").modal({backdrop:"static",keyboard:!1})},toggleEditMode:function(t){t.isEdit?t.isEdit=!1:(t.isEdit=!0,setTimeout(function(){$(".edit-category-input").focus()},50))},getCategories:function(){var t=this,e=this.token;$.ajax({url:"/admin/category/get",type:"POST",cache:!1,data:{type:"product"},beforeSend:function(t){t.setRequestHeader("X-CSRF-TOKEN",e)}}).done(function(e){t.categories=[],e.forEach(function(e){t.categories.push({categoryParent:e.parentId,name:e.title,guid:e.guid,isEdit:!1,description:e.description,featureImage:e.featureImage})})}).fail(function(){console.log("error")}).always(function(){console.log("complete")})},showMessage:function(t,e){toastr[t](e)}}}},228:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[t._m(0),t._v(" "),a("div",{staticClass:"tab-content"},[a("div",{staticClass:"tab-pane fade in active",attrs:{id:"category-list"}},[a("div",{staticClass:"panel-body"},[a("table",{staticClass:"table field-table"},[t._m(1),t._v(" "),a("tbody",t._l(t.categories,function(e){return a("tr",[a("td",[a("img",{attrs:{width:"40",src:e.featureImage}})]),t._v(" "),a("td",[a("span",[t._v(t._s(e.name))])]),t._v(" "),a("td",{attrs:{align:"center"}},[a("span",{staticClass:"glyphicon glyphicon-pencil",on:{click:function(a){t.openEditModal(e)}}})]),t._v(" "),a("td",{attrs:{align:"center"}},[a("span",{staticClass:"glyphicon glyphicon-trash",on:{click:function(a){t.deleteCategory(e.guid)}}})])])}))])])]),t._v(" "),a("div",{staticClass:"tab-pane fade",attrs:{id:"add-category"}},[a("div",{staticClass:"panel-body"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"exampleInputEmail1"}},[t._v("\n                            類別名稱\n                        ")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.addCategoryForm.categoryName,expression:"addCategoryForm.categoryName"}],staticClass:"form-control",attrs:{type:"email"},domProps:{value:t.addCategoryForm.categoryName},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.addCategory()},input:function(e){e.target.composing||t.$set(t.addCategoryForm,"categoryName",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"exampleInputPassword1"}},[t._v("\n                            上層\n                        ")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.addCategoryForm.categoryParent,expression:"addCategoryForm.categoryParent"}],staticClass:"form-control",attrs:{id:"parent-select",name:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.addCategoryForm,"categoryParent",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"null"}},[t._v("--不指定--")]),t._v(" "),t._l(t.categories,function(e){return a("option",{domProps:{value:e.guid}},[t._v(" "+t._s(e.name))])})],2)]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"exampleInputEmail1"}},[t._v("\n                            類別描述\n                        ")]),t._v(" "),a("ckeditor",{staticClass:"ch-product-description",attrs:{id:"add-area",config:t.ckConfig},model:{value:t.addCategoryForm.description,callback:function(e){t.$set(t.addCategoryForm,"description",e)},expression:"addCategoryForm.description"}})],1),t._v(" "),a("button",{staticClass:"btn btn-success",attrs:{type:"button",name:"button"},on:{click:function(e){t.addImage()}}},[t._v("選擇圖片")]),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:t.addCategoryForm.featureImage,width:"50%"}})])]),t._v(" "),a("div",{staticClass:"panel-footer"},[a("button",{staticClass:"btn btn-primary",on:{click:function(e){t.addCategory()}}},[t._v("\n                        新增\n                    ")])])])])]),t._v(" "),a("div",{staticClass:"modal fade",attrs:{id:"myModal",role:"dialog"}},[a("div",{staticClass:"modal-dialog modal-lg"},[a("div",{staticClass:"modal-content"},[t._m(2),t._v(" "),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"exampleInputEmail1"}},[t._v("\n                                    類別名稱\n                                ")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.editCategoryForm.categoryName,expression:"editCategoryForm.categoryName"}],staticClass:"form-control",attrs:{type:"email"},domProps:{value:t.editCategoryForm.categoryName},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.addCategory()},input:function(e){e.target.composing||t.$set(t.editCategoryForm,"categoryName",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"exampleInputPassword1"}},[t._v("\n                                    上層\n                                ")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.addCategoryForm.categoryParent,expression:"addCategoryForm.categoryParent"}],staticClass:"form-control",attrs:{id:"parent-select",name:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.addCategoryForm,"categoryParent",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"null"}},[t._v("--不指定--")]),t._v(" "),t._l(t.categories,function(e){return a("option",{domProps:{value:e.guid}},[t._v(" "+t._s(e.name))])})],2)])]),t._v(" "),a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"exampleInputEmail1"}},[t._v("\n                                    代表圖片\n                                ")]),t._v(" "),a("br"),t._v(" "),a("button",{staticClass:"btn btn-success",attrs:{type:"button",name:"button"},on:{click:function(e){t.editImage()}}},[t._v("選擇圖片")]),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{"max-width":"300px"},attrs:{src:t.editCategoryForm.featureImage}})])])]),t._v(" "),a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"exampleInputEmail1"}},[t._v("\n                                    類別描述\n                                ")]),t._v(" "),a("ckeditor",{staticClass:"ch-product-description",attrs:{id:"edit-area",config:t.ckConfig},model:{value:t.editCategoryForm.description,callback:function(e){t.$set(t.editCategoryForm,"description",e)},expression:"editCategoryForm.description"}})],1)])])]),t._v(" "),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-success",attrs:{type:"button"},on:{click:function(e){t.editCategory(t.editCategoryForm)}}},[t._v("儲存類別")])])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("ul",{staticClass:"nav nav-tabs"},[e("li",{staticClass:"active"},[e("a",{attrs:{"data-toggle":"tab",href:"#category-list"}},[this._v("類別列表")])]),this._v(" "),e("li",[e("a",{attrs:{"data-toggle":"tab",href:"#add-category"}},[this._v("新增類別")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",{attrs:{width:"50"}}),this._v(" "),e("th",[this._v("類別名稱")]),this._v(" "),e("th",{staticStyle:{"text-align":"center"},attrs:{width:"50"}},[this._v("編輯")]),this._v(" "),e("th",{staticStyle:{"text-align":"center"},attrs:{width:"50"}},[this._v("刪除")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[this._v("×")]),this._v(" "),e("h4",{staticClass:"modal-title"},[this._v("編輯類別")])])}]}}});