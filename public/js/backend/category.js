!function(t){function e(n){if(a[n])return a[n].exports;var o=a[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var a={};e.m=t,e.c=a,e.d=function(t,a,n){e.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=234)}({1:function(t,e){t.exports=function(t,e,a,n,o,r){var s,i=t=t||{},c=typeof t.default;"object"!==c&&"function"!==c||(s=t,i=t.default);var l="function"==typeof i?i.options:i;e&&(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0),a&&(l.functional=!0),o&&(l._scopeId=o);var d;if(r?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},l._ssrRegister=d):n&&(d=n),d){var u=l.functional,g=u?l.render:l.beforeCreate;u?(l._injectStyles=d,l.render=function(t,e){return d.call(e),g(t,e)}):l.beforeCreate=g?[].concat(g,d):[d]}return{esModule:s,exports:i,options:l}}},234:function(t,e,a){t.exports=a(235)},235:function(t,e,a){Vue.component("category",a(236));new Vue({el:"#categoryElment"})},236:function(t,e,a){var n=a(1)(a(237),a(238),!1,null,null,null);t.exports=n.exports},237:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{addCategoryForm:{categoryName:"",categoryParent:"null",type:"post"},categories:[],token:$('meta[name="csrf-token"]').attr("content")}},created:function(){this.getCategories(),$(".loading-bar").fadeOut("100")},methods:{addCategory:function(){var t=this,e=this.token;void 0===t.addCategoryForm.categoryParent&&(t.addCategoryForm.categoryParent=null),""!==t.addCategoryForm.categoryName.trim()?($(".loading-bar").fadeIn("100"),$.ajax({url:"/admin/category/add",type:"POST",cache:!1,dataType:"json",data:t.addCategoryForm,beforeSend:function(t){t.setRequestHeader("X-CSRF-TOKEN",e)}}).done(function(e){t.showMessage("success","新增類別成功"),t.addCategoryForm.categoryParent="null",t.addCategoryForm.categoryName=""}).fail(function(){console.log("error")}).always(function(){t.getCategories(),$(".loading-bar").fadeOut("100")})):this.showMessage("warning","欄位名稱不可為空白")},editCategory:function(t){var e=this.token;""!==t.name.trim()?($(".loading-bar").fadeIn("100"),$.ajax({url:"/admin/category/update",type:"POST",dataType:"json",data:{category:t.guid},beforeSend:function(t){t.setRequestHeader("X-CSRF-TOKEN",e)}}).done(function(t){console.log("success")}).fail(function(t){console.log("error")}).always(function(){$(".edit-category-input").blur(),$(".loading-bar").fadeOut("100"),console.log("complete")})):this.showMessage("warning","欄位名稱不可為空白")},deleteCategory:function(t){var e=this,a=this.token;confirm("是否刪除類別?")&&$.ajax({url:"/admin/category/delete",type:"POST",dataType:"json",data:{category:t},beforeSend:function(t){t.setRequestHeader("X-CSRF-TOKEN",a)}}).done(function(t){e.showMessage("success",t.message)}).fail(function(t){e.showMessage("error",t.responseJSON.message)}).always(function(){e.getCategories()})},toggleEditMode:function(t){t.isEdit?t.isEdit=!1:(t.isEdit=!0,setTimeout(function(){$(".edit-category-input").focus()},50))},getCategories:function(){var t=this,e=this.token;$.ajax({url:"/admin/category/get",type:"POST",cache:!1,data:{type:"post"},beforeSend:function(t){t.setRequestHeader("X-CSRF-TOKEN",e)}}).done(function(e){t.categories=[],e.forEach(function(e){t.categories.push({name:e.title,guid:e.guid,isEdit:!1})})}).fail(function(){console.log("error")}).always(function(){console.log("complete")})},showMessage:function(t,e){toastr[t](e)}}}},238:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-6"},[a("div",{staticClass:"panel panel-default"},[t._m(0),t._v(" "),a("div",{staticClass:"panel-body"},[a("table",{staticClass:"table field-table"},[t._m(1),t._v(" "),a("tbody",t._l(t.categories,function(e){return a("tr",[a("td",[e.isEdit?a("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"item.name"}],staticClass:"edit-category-input",staticStyle:{width:"100%"},attrs:{type:"text"},domProps:{value:e.name},on:{blur:function(a){t.toggleEditMode(e)},keyup:function(a){if(!("button"in a)&&t._k(a.keyCode,"enter",13,a.key))return null;t.editCategory(e)},input:function(a){a.target.composing||t.$set(e,"name",a.target.value)}}}):a("span",[t._v(t._s(e.name))])]),t._v(" "),a("td",{attrs:{align:"center"}},[a("span",{staticClass:"glyphicon glyphicon-pencil",on:{click:function(a){t.toggleEditMode(e)}}})]),t._v(" "),a("td",{attrs:{align:"center"}},[a("span",{staticClass:"glyphicon glyphicon-trash",on:{click:function(a){t.deleteCategory(e.guid)}}})])])}))])]),t._v(" "),a("div",{staticClass:"panel-footer"})])]),t._v(" "),a("div",{staticClass:"col-md-6"},[a("div",{staticClass:"panel panel-default"},[t._m(2),t._v(" "),a("div",{staticClass:"panel-body"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"exampleInputEmail1"}},[t._v("\n                        類別名稱\n                    ")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.addCategoryForm.categoryName,expression:"addCategoryForm.categoryName"}],staticClass:"form-control",attrs:{type:"email"},domProps:{value:t.addCategoryForm.categoryName},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.addCategory()},input:function(e){e.target.composing||t.$set(t.addCategoryForm,"categoryName",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"exampleInputPassword1"}},[t._v("\n                        上層\n                    ")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.addCategoryForm.categoryParent,expression:"addCategoryForm.categoryParent"}],staticClass:"form-control",attrs:{id:"parent-select",name:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.addCategoryForm,"categoryParent",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"null"}},[t._v("--不指定--")]),t._v(" "),t._l(t.categories,function(e){return a("option",{domProps:{value:e.guid}},[t._v(" "+t._s(e.name))])})],2)])]),t._v(" "),a("div",{staticClass:"panel-footer"},[a("button",{staticClass:"btn btn-primary",on:{click:function(e){t.addCategory()}}},[t._v("\n                    新增\n                ")])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"panel-heading"},[e("h3",{staticClass:"panel-title"},[this._v("\n                    類別管理\n                ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("類別名稱")]),this._v(" "),e("th",{staticStyle:{"text-align":"center"},attrs:{width:"50"}},[this._v("編輯")]),this._v(" "),e("th",{staticStyle:{"text-align":"center"},attrs:{width:"50"}},[this._v("刪除")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"panel-heading"},[e("h3",{staticClass:"panel-title"},[this._v("\n                    新增類別\n                ")])])}]}}});