!function(t){function e(s){if(i[s])return i[s].exports;var a=i[s]={i:s,l:!1,exports:{}};return t[s].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var i={};e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:s})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=274)}({1:function(t,e){t.exports=function(t,e,i,s,a,o){var n,r=t=t||{},d=typeof t.default;"object"!==d&&"function"!==d||(n=t,r=t.default);var c="function"==typeof r?r.options:r;e&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0),i&&(c.functional=!0),a&&(c._scopeId=a);var l;if(o?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},c._ssrRegister=l):s&&(l=s),l){var h=c.functional,u=h?c.render:c.beforeCreate;h?(c._injectStyles=l,c.render=function(t,e){return l.call(e),u(t,e)}):c.beforeCreate=u?[].concat(u,l):[l]}return{esModule:n,exports:r,options:c}}},274:function(t,e,i){t.exports=i(275)},275:function(t,e,i){Vue.component("order-list",i(276));new Vue({el:"#order-list"})},276:function(t,e,i){var s=i(1)(i(277),i(278),!1,null,null,null);t.exports=s.exports},277:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{merchantID:"",orderList:[],next_page_url:null,prev_page_url:null,total:null,current_page:null,eachPage:[],itemShowed:{},orderStatus:"all",token:$('meta[name="csrf-token"]').attr("content")}},watch:{orderStatus:function(t){console.log(t),this.getOrders("/order/get/"+t)}},created:function(){this.getOrders("/order/get/"+this.orderStatus),$(".loading-bar").fadeOut("100")},methods:{toggleStatusModify:function(){console.log(this.itemShowed.statusModify),this.itemShowed.statusModify=!this.itemShowed.statusModify},searchOrder:function(){console.log(this.merchantID),this.getOrders("/order/search/"+this.merchantID)},statusViewChange:function(t){this.orderStatus=t},getOrders:function(t){var e=this;$.ajax({url:t,type:"GET",dataType:"json"}).done(function(t){e.orderList=[],e.next_page_url=t.next_page_url,e.prev_page_url=t.prev_page_url,e.current_page=t.current_page,e.total=t.total,e.eachPage=[],t.data.forEach(function(t){e.orderList.push({guid:t.guid,owner:t.owner,merchantID:t.merchantID,content:JSON.parse(t.content),amount:t.amount,pointUsage:t.pointUsage,status:t.status,orderStatus:t.orderStatus,paymentStatus:t.paymentStatus,paymentMethod:t.paymentMethod,shippingMethod:t.shippingMethod,usedCoupon:JSON.parse(t.usedCoupon),ExpireDate:t.ExpireDate,BankCode:t.BankCode,PaymentType:t.PaymentType,vAccount:t.vAccount,shippingTarget:JSON.parse(t.shippingTarget),remarks:t.remarks,created_at:t.created_at,statusModify:!1})});for(var i=0;i<t.last_page;i++)e.eachPage.push({pageNumber:i+1})}).fail(function(){console.log("error")}).always(function(){console.log("complete")})},openModal:function(t){this.itemShowed={},this.itemShowed=t,this.itemShowed.statusModify&&(this.itemShowed.statusModify=!1),$("#detail-modal").modal("show")},generateCvs:function(t){var e=this,i=this.token;$(".loading-bar").show(),$.ajax({url:"/order/generate-cvs",type:"POST",dataType:"json",data:{LogisticsType:"cvs"===e.itemShowed.shippingMethod?"CVS":"Home",LogisticsSubType:"cvs"===e.itemShowed.shippingMethod?e.itemShowed.shippingTarget.LogisticsSubType:"TCAT",ReceiverPort:"cvs"!==e.itemShowed.shippingMethod?e.itemShowed.shippingTarget.ReceiverPort:"",Temperature:t,ReceiverAddress:"cvs"!==e.itemShowed.shippingMethod?e.itemShowed.shippingTarget.ReceiverCity+e.itemShowed.shippingTarget.ReceiverAddress:"",TotalAmount:e.itemShowed.amount,guid:e.itemShowed.guid,ReceiverName:e.itemShowed.shippingTarget.ReceiverName,ReceiverCellPhone:e.itemShowed.shippingTarget.ReceiverCellPhone,ReceiverEmail:"vincent7697@gmail.com",CVSStoreID:e.itemShowed.shippingTarget.CVSStoreID,Remark:e.itemShowed.remarks},beforeSend:function(t){t.setRequestHeader("X-CSRF-TOKEN",i)}}).done(function(t){"300"===t.RtnCode&&(e.itemShowed.status="shippingGenerated",e.itemShowed.shippingTarget.MerchantID=t.MerchantID,e.itemShowed.shippingTarget.AllPayLogisticsID=t.AllPayLogisticsID,e.itemShowed.shippingTarget.CVSPaymentNo=t.CVSPaymentNo,e.itemShowed.shippingTarget.CVSValidationNo=t.CVSValidationNo,e.orderList.forEach(function(i){i.guid===e.itemShowed.guid&&(i.status="shippingGenerated",i.shippingTarget.MerchantID=t.MerchantID,i.shippingTarget.AllPayLogisticsID=t.AllPayLogisticsID,i.shippingTarget.CVSPaymentNo=t.CVSPaymentNo,i.shippingTarget.CVSValidationNo=t.CVSValidationNo)}))}).fail(function(){console.log("error")}).always(function(){$(".loading-bar").hide(),console.log("complete")})},modifyOrderStatus:function(){var t=this.token;$(".loading-bar").fadeIn("100"),$.ajax({url:"/order/updateStatus",type:"POST",dataType:"json",data:{guid:this.itemShowed.guid,orderStatus:this.itemShowed.orderStatus,owner:this.itemShowed.owner},beforeSend:function(e){e.setRequestHeader("X-CSRF-TOKEN",t)}}).done(function(t){console.log(t),$("#detail-modal").modal("hide")}).fail(function(){console.log("error")}).always(function(){$(".loading-bar").fadeOut("100"),console.log("complete")})},generateSheet:function(){var t=this.token;$(".loading-bar").show(),$.ajax({url:"/order/generate-sheet",type:"POST",dataType:"json",data:{LogisticsSubType:"cvs"!==this.itemShowed.shippingMethod?"Home":this.itemShowed.shippingTarget.LogisticsSubType,MerchantID:this.itemShowed.shippingTarget.MerchantID,AllPayLogisticsID:this.itemShowed.shippingTarget.AllPayLogisticsID,CVSPaymentNo:this.itemShowed.shippingTarget.CVSPaymentNo,CVSValidationNo:this.itemShowed.shippingTarget.CVSValidationNo},beforeSend:function(e){e.setRequestHeader("X-CSRF-TOKEN",t)}}).done(function(t){}).fail(function(t,e,i){var s=document.createElement("iframe");s.id="sheet-iframe",s.style.width="100%",s.style.height="200px",s.style.border="0",document.getElementById("sheet-frame-container").appendChild(s),document.getElementById("sheet-iframe").contentDocument.write(t.responseText),$("#sheet-modal").modal("show"),$("body").on("click",function(){$("#sheet-iframe").remove()})}).always(function(){$(".loading-bar").hide(),console.log("complete")})},nextPage:function(){this.getOrders(this.next_page_url)},prevPage:function(){this.getOrders(this.prev_page_url)},gotoPage:function(t){this.getOrders("/order/get?page="+t.pageNumber)}}}},278:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-12"},[i("form",{on:{submit:function(e){e.preventDefault(),t.searchOrder(e)}}},[i("div",{staticClass:"input-group",staticStyle:{width:"250px"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.merchantID,expression:"merchantID"}],staticClass:"form-control",attrs:{type:"text",placeholder:"訂單編號"},domProps:{value:t.merchantID},on:{input:function(e){e.target.composing||(t.merchantID=e.target.value)}}}),t._v(" "),t._m(0)])])]),t._v(" "),i("div",{staticClass:"col-md-12"},[i("ul",{staticClass:"order-cate-list"},[i("li",{class:{active:"all"==t.orderStatus},on:{click:function(e){t.statusViewChange("all")}}},[t._v("全部")]),t._v(" "),i("li",{class:{active:"unpaid"==t.orderStatus},on:{click:function(e){t.statusViewChange("unpaid")}}},[t._v("未付款")]),t._v(" "),i("li",{class:{active:"paid"==t.orderStatus},on:{click:function(e){t.statusViewChange("paid")}}},[t._v("已付款")])])]),t._v(" "),i("div",{staticClass:"col-md-12"},[i("table",{staticClass:"table field-table"},[t._m(1),t._v(" "),i("tbody",t._l(t.orderList,function(e){return i("tr",[i("td",[t._v(t._s(e.merchantID))]),t._v(" "),i("td",[t._v(t._s(e.created_at))]),t._v(" "),i("td",["unpaid"===e.paymentStatus?i("span",{staticStyle:{color:"red","font-weight":"bold"}},[t._v("未付款")]):i("span",{staticStyle:{color:"green","font-weight":"bold"}},[t._v("已付款")])]),t._v(" "),i("td",[t._v(t._s(e.content[0].Name)+" x "+t._s(e.content[0].qty)+" ...")]),t._v(" "),i("td",["undisposed"==e.orderStatus?i("span",{staticStyle:{color:"brown","font-weight":"bold"}},[t._v("未處理")]):t._e(),t._v(" "),"disposed"==e.orderStatus?i("span",{staticStyle:{color:"green","font-weight":"bold"}},[t._v("已出貨")]):t._e(),t._v(" "),"canceled"==e.orderStatus?i("span",{staticStyle:{color:"red","font-weight":"bold"}},[t._v("已取消")]):t._e(),t._v(" "),"success"==e.orderStatus?i("span",{staticStyle:{color:"blue","font-weight":"bold"}},[t._v("完成")]):t._e()]),t._v(" "),i("td",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.amount))]),t._v(" "),i("td",{attrs:{align:"center"}},[i("button",{staticClass:"btn btn-default btn-sm",on:{click:function(i){t.openModal(e)}}},[t._v("查看")])])])}))]),t._v(" "),i("ul",{staticClass:"pagination"},[t.prev_page_url?i("li",[i("a",{attrs:{href:"#"},on:{click:function(e){t.prevPage()}}},[t._v("上一頁")])]):t._e(),t._v(" "),t._l(t.eachPage,function(e){return i("li",[i("a",{attrs:{href:"#"},on:{click:function(i){t.gotoPage(e)}}},[t._v(t._s(e.pageNumber))])])}),t._v(" "),t.next_page_url?i("li",[i("a",{attrs:{href:"#"},on:{click:function(e){t.nextPage()}}},[t._v("下一頁")])]):t._e()],2),t._v(" "),i("div",{staticClass:"modal fade",attrs:{id:"detail-modal",role:"dialog","data-backdrop":"static"}},[i("div",{staticClass:"modal-dialog modal-md"},[i("div",{staticClass:"modal-content"},[t._m(2),t._v(" "),i("div",{staticClass:"modal-body"},[i("table",{staticClass:"table product-detail-table"},[i("tr",[i("td",[t._v("訂單編號")]),t._v(" "),i("td",[t._v(t._s(t.itemShowed.merchantID))])]),t._v(" "),i("tr",[i("td",[t._v("商品內容")]),t._v(" "),i("td",[i("table",{staticClass:"table"},[t._m(3),t._v(" "),i("tbody",t._l(t.itemShowed.content,function(e){return i("tr",[i("td",[t._v(t._s(e.Name))]),t._v(" "),i("td",[t._v(t._s(e.qty))]),t._v(" "),i("td",[t._v(t._s(e.price))])])}))])])]),t._v(" "),i("tr",[i("td",[t._v("訂單金額")]),t._v(" "),i("td",[t._v("NT$ "+t._s(t.itemShowed.amount))])]),t._v(" "),i("tr",[i("td",[t._v("點數使用")]),t._v(" "),i("td",[t._v("NT$ "+t._s(t.itemShowed.pointUsage))])]),t._v(" "),t.itemShowed.usedCoupon?i("tr",[i("td",[t._v("優惠券使用")]),t._v(" "),i("td",[i("table",{staticClass:"table"},[t._m(4),t._v(" "),i("tbody",[i("tr",[i("td",["percentage"===t.itemShowed.usedCoupon.discountType?i("span",[t._v("百分比折抵")]):t._e(),t._v(" "),"cartDiscount"===t.itemShowed.usedCoupon.discountType?i("span",[t._v("總額折抵")]):t._e()]),t._v(" "),i("td",["percentage"===t.itemShowed.usedCoupon.discountType?i("span",[t._v(t._s(t.itemShowed.usedCoupon.couponAmount)+" %")]):t._e(),t._v(" "),"cartDiscount"===t.itemShowed.usedCoupon.discountType?i("span",[t._v("NT$ "+t._s(t.itemShowed.usedCoupon.couponAmount))]):t._e()])])])])])]):t._e(),t._v(" "),i("tr",[i("td",[t._v("付款方式")]),t._v(" "),i("td",["ATM"===t.itemShowed.paymentMethod?i("span",[t._v("ATM轉帳")]):t._e(),t._v(" "),"Credit"===t.itemShowed.paymentMethod?i("span",[t._v("信用卡付款")]):t._e(),t._v(" "),"cod"===t.itemShowed.paymentMethod?i("span",[t._v("貨到付款")]):t._e()])]),t._v(" "),i("tr",[i("td",[t._v("\n                                    付款狀態\n                                ")]),t._v(" "),i("td",["paid"===t.itemShowed.paymentStatus?i("span",{staticStyle:{"font-weight":"bold",color:"green"}},[t._v("已付款")]):i("span",{staticStyle:{"font-weight":"bold",color:"red"}},[t._v("未付款")]),t._v(" "),"cod"!==t.itemShowed.paymentMethod&&"paid"===t.itemShowed.paymentStatus&&"unpaid"===t.itemShowed.status&&"delivery"===t.itemShowed.shippingMethod?i("button",{staticClass:"btn btn-success btn-xs",staticStyle:{"margin-left":"10px"},attrs:{type:"button"},on:{click:function(e){t.generateCvs("0001")}}},[t._v("已付款，產生常溫物流單")]):t._e(),t._v(" "),"cod"!==t.itemShowed.paymentMethod&&"paid"===t.itemShowed.paymentStatus&&"unpaid"===t.itemShowed.status&&"delivery"===t.itemShowed.shippingMethod?i("button",{staticClass:"btn btn-success btn-xs",staticStyle:{"margin-left":"10px"},attrs:{type:"button"},on:{click:function(e){t.generateCvs("0002")}}},[t._v("已付款，產生低溫物流單")]):t._e(),t._v(" "),"cod"!==t.itemShowed.paymentMethod&&"paid"===t.itemShowed.paymentStatus&&"unpaid"===t.itemShowed.status&&"cvs"===t.itemShowed.shippingMethod?i("button",{staticClass:"btn btn-success btn-xs",staticStyle:{"margin-left":"10px"},attrs:{type:"button"},on:{click:function(e){t.generateCvs("0002")}}},[t._v("已付款，產生超商物流單")]):t._e(),t._v(" "),"cod"!==t.itemShowed.paymentMethod&&"paid"===t.itemShowed.paymentStatus&&"shippingGenerated"===t.itemShowed.status?i("button",{staticClass:"btn btn-info btn-xs",staticStyle:{"margin-left":"10px"},attrs:{type:"button"},on:{click:function(e){t.generateSheet()}}},[t._v("已產生物流單，點我列印繳費單")]):t._e(),t._v(" "),"cod"===t.itemShowed.paymentMethod?i("button",{staticClass:"btn btn-success btn-xs",staticStyle:{"margin-left":"10px"},attrs:{type:"button"},on:{click:function(e){t.generateSheet()}}},[t._v("已產生貨到付款物流單，點我列印繳費單")]):t._e()])]),t._v(" "),i("tr",[i("td",[t._v("訂單狀態")]),t._v(" "),i("td",[t.itemShowed.statusModify?i("div",[i("select",{directives:[{name:"model",rawName:"v-model",value:t.itemShowed.orderStatus,expression:"itemShowed.orderStatus"}],on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.itemShowed,"orderStatus",e.target.multiple?i:i[0])}}},["undisposed"==t.itemShowed.orderStatus?i("option",{attrs:{value:"undisposed",selected:""}},[t._v("未處理")]):i("option",{attrs:{value:"undisposed"}},[t._v("未處理")]),t._v(" "),"disposed"==t.itemShowed.orderStatus?i("option",{attrs:{value:"disposed",selected:""}},[t._v("已出貨")]):i("option",{attrs:{value:"disposed"}},[t._v("已出貨")]),t._v(" "),"canceled"==t.itemShowed.orderStatus?i("option",{attrs:{value:"canceled",selected:""}},[t._v("已取消")]):i("option",{attrs:{value:"canceled"}},[t._v("已取消")]),t._v(" "),"success"==t.itemShowed.orderStatus?i("option",{attrs:{value:"success",selected:""}},[t._v("完成")]):i("option",{attrs:{value:"success"}},[t._v("完成")])]),t._v(" "),i("button",{attrs:{type:"button",name:"button"},on:{click:function(e){t.modifyOrderStatus()}}},[i("i",{staticClass:"fa fa-check",attrs:{"aria-hidden":"true"}})])]):i("div",["undisposed"==t.itemShowed.orderStatus?i("span",{staticStyle:{color:"brown","font-weight":"bold"}},[t._v("未處理")]):t._e(),t._v(" "),"disposed"==t.itemShowed.orderStatus?i("span",{staticStyle:{color:"green","font-weight":"bold"}},[t._v("已出貨")]):t._e(),t._v(" "),"canceled"==t.itemShowed.orderStatus?i("span",{staticStyle:{color:"red","font-weight":"bold"}},[t._v("已取消")]):t._e(),t._v(" "),"success"==t.itemShowed.orderStatus?i("span",{staticStyle:{color:"blue","font-weight":"bold"}},[t._v("完成")]):t._e(),t._v(" "),"canceled"==t.itemShowed.orderStatus?i("button",{staticClass:"btn btn-default",attrs:{type:"button",name:"button",disabled:""}},[t._v("更改狀態")]):i("button",{staticClass:"btn btn-default",attrs:{type:"button",name:"button"},on:{click:function(e){t.toggleStatusModify()}}},[t._v("更改狀態")])])])]),t._v(" "),i("tr",[i("td",[t._v("運送方式")]),t._v(" "),i("td",["delivery"===t.itemShowed.shippingMethod?i("span",[t._v("國內宅配")]):t._e(),t._v(" "),"cvs"===t.itemShowed.shippingMethod?i("span",[t._v("超商取貨")]):t._e()])]),t._v(" "),i("tr",[i("td",[t._v("客戶資訊")]),t._v(" "),i("td",[t.itemShowed.shippingTarget?i("table",{staticClass:"table"},[i("tr",[i("td",[t._v("客戶名稱")]),t._v(" "),i("td",[t._v(t._s(t.itemShowed.shippingTarget.ReceiverName))])]),t._v(" "),i("tr",[i("td",[t._v("客戶電話")]),t._v(" "),i("td",[t._v(t._s(t.itemShowed.shippingTarget.ReceiverCellPhone))])]),t._v(" "),i("tr",[i("td",[t._v("電子郵件")]),t._v(" "),i("td",[t._v(t._s(t.itemShowed.shippingTarget.ReceiverEmail))])])]):t._e()])]),t._v(" "),i("tr",[i("td",[t._v("運送標的")]),t._v(" "),i("td",["cvs"===t.itemShowed.shippingMethod?i("table",{staticClass:"table"},[i("tr",[i("td",[t._v("取貨店家")]),t._v(" "),i("td",[t._v(t._s(t.itemShowed.shippingTarget.CVSStoreName))])]),t._v(" "),i("tr",[i("td",[t._v("店家地址")]),t._v(" "),i("td",[t._v(t._s(t.itemShowed.shippingTarget.CVSAddress))])])]):t._e(),t._v(" "),"delivery"===t.itemShowed.shippingMethod?i("span",[t._v("\n                                        "+t._s(t.itemShowed.shippingTarget.ReceiverPort+t.itemShowed.shippingTarget.ReceiverCity+t.itemShowed.shippingTarget.ReceiverAddress)+"\n                                    ")]):t._e()])]),t._v(" "),i("tr",[i("td",[t._v("備註")]),t._v(" "),i("td",[t._v("\n                                    "+t._s(t.itemShowed.remarks)+"\n                                ")])])])]),t._v(" "),t._m(5)])])]),t._v(" "),t._m(6)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"input-group-btn"},[e("button",{staticClass:"btn btn-default",attrs:{type:"submit"}},[this._v("搜尋訂單")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("訂單編號")]),this._v(" "),e("th",[this._v("購買日期時間")]),this._v(" "),e("th",[this._v("付款狀態")]),this._v(" "),e("th",[this._v("訂單內容")]),this._v(" "),e("th",[this._v("訂單狀態")]),this._v(" "),e("th",{staticStyle:{"text-align":"center"}},[this._v("訂單金額")]),this._v(" "),e("th",{staticStyle:{"text-align":"center"}},[this._v("操作")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[this._v("×")]),this._v(" "),e("h4",{staticClass:"modal-title"},[this._v("訂單詳細資訊")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("商品")]),this._v(" "),e("th",[this._v("數量")]),this._v(" "),e("th",[this._v("單價")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("優惠券類型")]),this._v(" "),e("th",[this._v("折抵金額")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-default",attrs:{type:"button","data-dismiss":"modal"}},[this._v("關閉")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal fade",attrs:{id:"sheet-modal",role:"dialog","data-backdrop":"static"}},[e("div",{staticClass:"modal-dialog modal-md"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[this._v("×")]),this._v(" "),e("h4",{staticClass:"modal-title"},[this._v("配送單資訊")])]),this._v(" "),e("div",{staticClass:"modal-body",attrs:{id:"sheet-frame-container"}}),this._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-default",attrs:{type:"button","data-dismiss":"modal"}},[this._v("關閉")])])])])])}]}}});