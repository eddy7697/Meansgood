!function(t){function e(i){if(n[i])return n[i].exports;var a=n[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=294)}({1:function(t,e){t.exports=function(t,e,n,i,a,s){var r,o=t=t||{},c=typeof t.default;"object"!==c&&"function"!==c||(r=t,o=t.default);var u="function"==typeof o?o.options:o;e&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0),n&&(u.functional=!0),a&&(u._scopeId=a);var l;if(s?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},u._ssrRegister=l):i&&(l=i),l){var p=u.functional,d=p?u.render:u.beforeCreate;p?(u._injectStyles=l,u.render=function(t,e){return l.call(e),d(t,e)}):u.beforeCreate=d?[].concat(d,l):[l]}return{esModule:r,exports:o,options:u}}},294:function(t,e,n){t.exports=n(295)},295:function(t,e,n){Vue.component("cart-page",n(296));new Vue({el:"#cart-page"})},296:function(t,e,n){var i=n(1)(n(297),n(298),!1,null,null,null);t.exports=i.exports},297:function(t,e,n){"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),$(".loading-bar").fadeOut("100"),e.default={data:function(){var t;return t={token:$('meta[name="csrf-token"]').attr("content"),cart:[],choosedShipping:null,shippingMethods:[],amount:null},i(t,"choosedShipping",null),i(t,"isDirty",!1),i(t,"isCartEmpty",!0),t},watch:{cart:{handler:function(t,e){this.isDirty=!0},deep:!0},choosedShipping:{handler:function(t,e){localStorage.setItem("choosedShipping",t)},deep:!0}},computed:{amountNum:function(){if(null==this.amount)return 0;for(var t=this.amount.split(","),e="",n=0;n<t.length;n++)e+=t[n];return parseInt(e)},totalAmount:function(){if(this.amount){for(var t=this,e=0,n=this.amount.split(","),i="",a=0;a<n.length;a++)i+=n[a];return this.shippingMethods.forEach(function(n){n.id==t.choosedShipping&&(e="1"==n.freeShipping&&i>=parseInt(n.freeShippingMininum)?parseInt(i):parseInt(i)+parseInt(n.shippingPrice))}),e}return this.amount},methodsTranslate:function(){var t=[];return this.shippingMethods.forEach(function(e){t.push({freeShipping:1==e.freeShipping,freeShippingMininum:e.freeShippingMininum,id:e.id,shippingPrice:e.shippingPrice,shippingTemperature:e.shippingTemperature,shippingTitle:e.shippingTitle,shippingType:e.shippingType})}),t}},created:function(){var t=this,e=new Promise(function(t,e){$.ajax({url:"/shipping/get",type:"GET",cache:!1,dataType:"json"}).done(function(e){t(e.data)}).fail(function(t){e(t)})}),n=new Promise(function(t,e){$.ajax({url:"/cart/checkTemp",type:"GET",cache:!1,dataType:"json"}).done(function(e){t(e)}).fail(function(t){e(t)})});Promise.all([e,n]).then(function(e){e[0].forEach(function(n){n.shippingTemperature===e[1].Temperature&&t.shippingMethods.push(n)})}),this.getCart()},methods:{updateCart:function(){var t=this;$(".loading-bar").fadeIn("100"),$.ajax({url:"/cart/update",type:"POST",dataType:"json",data:{cart:JSON.stringify(t.cart)},beforeSend:function(t){t.setRequestHeader("X-CSRF-TOKEN",token)}}).done(function(e){t.getCart(),t.showMessage("success","更新購物車成功"),$(".loading-bar").fadeOut("100")}).fail(function(){}).always(function(){})},getCart:function(){var t=this;$(".loading-bar").fadeIn("100"),$.ajax({url:"/cart/get",type:"GET",dataType:"json"}).done(function(e){t.cart=[],t.cart=e.cart,t.amount=e.amount,setTimeout(function(){t.isDirty=!1},100),0===e.cart.length?($("button.cart").removeClass("full"),t.isCartEmpty=!0,$("button.cart").find("img").attr("src","/img/icon/cart-empty.svg")):(t.isCartEmpty=!1,$("button.cart").find("img").attr("src","/img/icon/cart-full.svg"))}).fail(function(){}).always(function(){$(".loading-bar").fadeOut("100")})},deleteProduct:function(t){var e=this;confirm("確認要刪除此商品?")&&($(".loading-bar").fadeIn("100"),$.ajax({url:"/cart/delete/single/"+t.rowId,type:"POST",dataType:"json",beforeSend:function(t){t.setRequestHeader("X-CSRF-TOKEN",token)}}).done(function(t){e.getCart()}).fail(function(){}).always(function(){$(".loading-bar").fadeOut("100")}))},deleteAll:function(){var t=this;confirm("確認要刪除所有商品?")&&($(".loading-bar").fadeIn("100"),$.ajax({url:"/cart/delete/all",type:"GET",dataType:"json"}).done(function(e){t.getCart()}).fail(function(){}).always(function(){$(".loading-bar").fadeOut("100"),t.getCart()}))},changeQty:function(t,e){"up"==t?e.qty=parseInt(e.qty)+1:e.qty<=0||(e.qty=parseInt(e.qty)-1)},productLink:function(t){return"/product-deatil/"+t},showMessage:function(t,e){toastr[t](e)}}}},298:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isCartEmpty?n("div",{staticClass:"row"},[t._m(0)]):n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-8"},[n("table",{staticClass:"cart-list"},[t._m(1),t._v(" "),n("tbody",t._l(t.cart,function(e){return n("tr",[n("td",{staticClass:"product-remove"},[n("a",{staticClass:"remove",staticStyle:{"text-decoration":"none"},attrs:{href:"#","aria-label":"移除這項商品"},on:{click:function(n){t.deleteProduct(e)}}},[t._v("×")])]),t._v(" "),n("td",{staticClass:"product-thumbnail"},[n("a",{attrs:{href:t.productLink(e.id.guid)}},[n("img",{attrs:{width:"50",src:e.id.featureImage}})])]),t._v(" "),n("td",{staticClass:"product-name",attrs:{"data-title":"商品"}},[n("a",{attrs:{href:t.productLink(e.id.guid)}},[t._v(t._s(e.id.title))])]),t._v(" "),n("td",{staticClass:"product-price",attrs:{"data-title":"價格"}},[n("span",[n("span",[t._v("NT$")]),t._v(" "+t._s(e.price))])]),t._v(" "),n("td",{staticClass:"product-quantity",staticStyle:{"text-align":"center"},attrs:{width:"125","data-title":"數量"}},[n("div",{staticClass:"form-group",staticStyle:{width:"122px",float:"right","margin-top":"15px"}},[n("div",{staticClass:"input-group"},[n("span",{staticClass:"input-group-btn"},[n("button",{staticClass:"btn btn-default",attrs:{type:"button"},on:{click:function(n){t.changeQty("down",e)}}},[n("i",{staticClass:"fa fa-minus",attrs:{"aria-hidden":"true"}})])]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.qty,expression:"item.qty"}],staticClass:"form-control",staticStyle:{"text-align":"center",padding:"0px 10px"},attrs:{type:"number",id:"point-input",min:"0"},domProps:{value:e.qty},on:{input:function(n){n.target.composing||t.$set(e,"qty",n.target.value)}}}),t._v(" "),n("span",{staticClass:"input-group-btn"},[n("button",{staticClass:"btn btn-default",attrs:{type:"button"},on:{click:function(n){t.changeQty("up",e)}}},[n("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}})])])])])]),t._v(" "),n("td",{staticClass:"product-subtotal",attrs:{"data-title":"總計",align:"right"}},[n("span",[n("span",[t._v("NT$")]),t._v(" "+t._s(e.total))])])])}))]),t._v(" "),n("br"),t._v(" "),t.isDirty?n("button",{staticClass:"btn btn-default",attrs:{name:"button"},on:{click:t.updateCart}},[t._v("更新購物車")]):n("button",{staticClass:"btn btn-default",attrs:{name:"button",disabled:""}},[t._v("更新購物車")]),t._v(" "),n("button",{staticClass:"btn btn-default",attrs:{name:"button"},on:{click:t.deleteAll}},[t._v("清空購物車")])]),t._v(" "),n("div",{staticClass:"col-md-4"},[n("div",{staticClass:"cart-sidebar"},[n("div",{staticClass:"cart_totals calculated_shipping"},[t._m(2),t._v(" "),n("form",{attrs:{action:"/checkout/billing",method:"post"}},[n("input",{attrs:{type:"hidden",name:"_token"},domProps:{value:t.token}}),t._v(" "),n("table",{staticClass:"shop_table shop_table_responsive cart-list",attrs:{cellspacing:"0"}},[n("tbody",[n("tr",{staticClass:"cart-subtotal"},[n("th",[t._v("小計")]),t._v(" "),n("td",{attrs:{"data-title":"小計"}},[n("span",[n("span",[t._v("NT$")]),t._v(" "+t._s(t.amount))])])]),t._v(" "),n("tr",{staticClass:"shipping"},[n("th",[t._v("運送方式")]),t._v(" "),n("td",{attrs:{"data-title":"運送方式 1"}},[n("ul",{attrs:{id:"shipping_method"}},t._l(t.methodsTranslate,function(e){return n("li",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.choosedShipping,expression:"choosedShipping"}],staticClass:"shipping_method",attrs:{type:"radio",name:"shipping_method",id:e.id,required:""},domProps:{value:e.id,checked:t._q(t.choosedShipping,e.id)},on:{change:function(n){t.choosedShipping=e.id}}}),t._v(" "),e.freeShipping&&t.amountNum>=e.freeShippingMininum?n("label",{attrs:{for:e.id}},[t._v(t._s(e.shippingTitle)+": 滿額免運")]):n("label",{attrs:{for:e.id}},[t._v(t._s(e.shippingTitle)+": "),n("span",[n("span",[t._v("NT$")]),t._v(t._s(e.shippingPrice))])]),t._v(" "),t.amount<e.freeShippingMininum&&t.choosedShipping===e.id?n("div",[t._v("\n                                                購物滿 "+t._s(e.freeShippingMininum)+" 元即可享有免運費的優惠唷！\n                                            ")]):t._e()])}))])]),t._v(" "),n("tr",{staticClass:"order-total"},[n("th",[t._v("總計")]),t._v(" "),n("td",{attrs:{"data-title":"總計"}},[t._m(3),t._v(" "+t._s(t.totalAmount))])])])]),t._v(" "),t._m(4)])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-md-12"},[e("h3",{staticClass:"center",staticStyle:{padding:"250px 0","text-align":"center"}},[this._v("購物車裡面沒有商品，趕快去逛逛吧~")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",{attrs:{colspan:"3"}},[this._v("\n                        商品\n                    ")]),this._v(" "),e("th",[this._v("\n                        價格\n                    ")]),this._v(" "),e("th",{staticStyle:{"text-align":"center"}},[this._v("\n                        數量\n                    ")]),this._v(" "),e("th",{staticStyle:{"text-align":"right"}},[this._v("\n                        總計\n                    ")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("table",{staticClass:"cart-list",attrs:{cellspacing:"0"}},[e("thead",[e("tr",[e("th",{staticClass:"product-name",staticStyle:{"border-width":"3px"},attrs:{colspan:"2"}},[this._v("購物車總計")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("strong",[e("span",[e("span",[this._v("NT$")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("button",{staticClass:"btn btn-success btn-block check-btn",attrs:{type:"submit"}},[this._v("前往結帳")])])}]}}});